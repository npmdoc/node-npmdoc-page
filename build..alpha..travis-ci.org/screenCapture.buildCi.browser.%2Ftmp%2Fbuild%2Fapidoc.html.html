<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/visionmedia/page.js#readme">page (v1.7.1)</a>
</h1>
<h4>Tiny client-side router</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.page">module page</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page">
            function <span class="apidocSignatureSpan"></span>page
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Context">
            function <span class="apidocSignatureSpan">page.</span>Context
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Route">
            function <span class="apidocSignatureSpan">page.</span>Route
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.back">
            function <span class="apidocSignatureSpan">page.</span>back
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.base">
            function <span class="apidocSignatureSpan">page.</span>base
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.dispatch">
            function <span class="apidocSignatureSpan">page.</span>dispatch
            <span class="apidocSignatureSpan">(ctx)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.exit">
            function <span class="apidocSignatureSpan">page.</span>exit
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index">
            function <span class="apidocSignatureSpan">page.</span>index
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.redirect">
            function <span class="apidocSignatureSpan">page.</span>redirect
            <span class="apidocSignatureSpan">(from, to)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.replace">
            function <span class="apidocSignatureSpan">page.</span>replace
            <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.sameOrigin">
            function <span class="apidocSignatureSpan">page.</span>sameOrigin
            <span class="apidocSignatureSpan">(href)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.show">
            function <span class="apidocSignatureSpan">page.</span>show
            <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.start">
            function <span class="apidocSignatureSpan">page.</span>start
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.stop">
            function <span class="apidocSignatureSpan">page.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">page.</span>len</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.</span>Context.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.</span>Route.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.</span>callbacks</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.</span>exits</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">page.</span>current</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.Context">module page.Context</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Context.Context">
            function <span class="apidocSignatureSpan">page.</span>Context
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.Context.prototype">module page.Context.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Context.prototype.pushState">
            function <span class="apidocSignatureSpan">page.Context.prototype.</span>pushState
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Context.prototype.save">
            function <span class="apidocSignatureSpan">page.Context.prototype.</span>save
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.Route">module page.Route</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Route.Route">
            function <span class="apidocSignatureSpan">page.</span>Route
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.Route.prototype">module page.Route.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Route.prototype.match">
            function <span class="apidocSignatureSpan">page.Route.prototype.</span>match
            <span class="apidocSignatureSpan">(path, params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.Route.prototype.middleware">
            function <span class="apidocSignatureSpan">page.Route.prototype.</span>middleware
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.index">module page.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.index">
            function <span class="apidocSignatureSpan">page.</span>index
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.Context">
            function <span class="apidocSignatureSpan">page.index.</span>Context
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.Route">
            function <span class="apidocSignatureSpan">page.index.</span>Route
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.back">
            function <span class="apidocSignatureSpan">page.index.</span>back
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.base">
            function <span class="apidocSignatureSpan">page.index.</span>base
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.dispatch">
            function <span class="apidocSignatureSpan">page.index.</span>dispatch
            <span class="apidocSignatureSpan">(ctx)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.exit">
            function <span class="apidocSignatureSpan">page.index.</span>exit
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.redirect">
            function <span class="apidocSignatureSpan">page.index.</span>redirect
            <span class="apidocSignatureSpan">(from, to)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.replace">
            function <span class="apidocSignatureSpan">page.index.</span>replace
            <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.sameOrigin">
            function <span class="apidocSignatureSpan">page.index.</span>sameOrigin
            <span class="apidocSignatureSpan">(href)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.show">
            function <span class="apidocSignatureSpan">page.index.</span>show
            <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.start">
            function <span class="apidocSignatureSpan">page.index.</span>start
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.index.stop">
            function <span class="apidocSignatureSpan">page.index.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">page.index.</span>len</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.index.</span>callbacks</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.index.</span>exits</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">page.index.</span>current</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.page.page">module page.page</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.page">
            function <span class="apidocSignatureSpan">page.</span>page
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.Context">
            function <span class="apidocSignatureSpan">page.page.</span>Context
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.Route">
            function <span class="apidocSignatureSpan">page.page.</span>Route
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.back">
            function <span class="apidocSignatureSpan">page.page.</span>back
            <span class="apidocSignatureSpan">(path, state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.base">
            function <span class="apidocSignatureSpan">page.page.</span>base
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.dispatch">
            function <span class="apidocSignatureSpan">page.page.</span>dispatch
            <span class="apidocSignatureSpan">(ctx)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.exit">
            function <span class="apidocSignatureSpan">page.page.</span>exit
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.redirect">
            function <span class="apidocSignatureSpan">page.page.</span>redirect
            <span class="apidocSignatureSpan">(from, to)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.replace">
            function <span class="apidocSignatureSpan">page.page.</span>replace
            <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.sameOrigin">
            function <span class="apidocSignatureSpan">page.page.</span>sameOrigin
            <span class="apidocSignatureSpan">(href)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.show">
            function <span class="apidocSignatureSpan">page.page.</span>show
            <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.start">
            function <span class="apidocSignatureSpan">page.page.</span>start
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.page.page.stop">
            function <span class="apidocSignatureSpan">page.page.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">page.page.</span>len</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.page.</span>callbacks</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">page.page.</span>exits</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">page.page.</span>current</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page" id="apidoc.module.page">module page</a></h1>


    <h2>
        <a href="#apidoc.element.page.page" id="apidoc.element.page.page">
        function <span class="apidocSignatureSpan"></span>page
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function page(path, fn) {
  // &lt;callback&gt;
  if ('function' === typeof path) {
    return page('*', path);
  }

  // route &lt;path&gt; to &lt;callback ...&gt;
  if ('function' === typeof fn) {
    var route = new Route(/** @type {string} */ (path));
    for (var i = 1; i &lt; arguments.length; ++i) {
      page.callbacks.push(route.middleware(arguments[i]));
    }
    // show &lt;path&gt; with [state]
  } else if ('string' === typeof path) {
    page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
    // start [options]
  } else {
    page.start(path);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.Context" id="apidoc.element.page.Context">
        function <span class="apidocSignatureSpan">page.</span>Context
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Context(path, state) {
  if ('/' === path[0] &amp;&amp; 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;
  var i = path.indexOf('?');

  this.canonicalPath = path;
  this.path = path.replace(base, '') || '/';
  if (hashbang) this.path = this.path.replace('#!', '') || '/';

  this.title = document.title;
  this.state = state || {};
  this.state.path = path;
  this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';
  this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);
  this.params = {};

  // fragment
  this.hash = '';
  if (!hashbang) {
    if (!~this.path.indexOf('#')) return;
    var parts = this.path.split('#');
    this.path = parts[0];
    this.hash = decodeURLEncodedURIComponent(parts[1]) || '';
    this.querystring = this.querystring.split('#')[0];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.Route" id="apidoc.element.page.Route">
        function <span class="apidocSignatureSpan">page.</span>Route
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path, options) {
  options = options || {};
  this.path = (path === '*') ? '(.*)' : path;
  this.method = 'GET';
  this.regexp = pathtoRegexp(this.path,
    this.keys = [],
    options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.back" id="apidoc.element.page.back">
        function <span class="apidocSignatureSpan">page.</span>back
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">back = function (path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.back();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
      page.show(base, state);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

page.back = function(path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.<span class="apidocCodeKeywordSpan">back</span>();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.base" id="apidoc.element.page.base">
        function <span class="apidocSignatureSpan">page.</span>base
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base = function (path) {
  if (0 === arguments.length) return base;
  base = path;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * Fixed `location.origin` usage [fisch42]
  * Fixed `pushState()` when unhandled

1.1.0 / 2012-06-06
==================

  * Added `+` support to pathtoRegexp()
  * Added `page.<span class="apidocCodeKeywordSpan">base</span>(path)` support
  * Added dispatch option to `page()`. Closes #10
  * Added `Context#originalPath`
  * Fixed unhandled links when .base is present. Closes #11
  * Fixed: `Context#path` to "/"

0.0.2 / 2012-06-05
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.dispatch" id="apidoc.element.page.dispatch">
        function <span class="apidocSignatureSpan">page.</span>dispatch
        <span class="apidocSignatureSpan">(ctx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (ctx) {
  var prev = prevContext,
    i = 0,
    j = 0;

  prevContext = ctx;

  function nextExit() {
    var fn = page.exits[j++];
    if (!fn) return nextEnter();
    fn(prev, nextExit);
  }

  function nextEnter() {
    var fn = page.callbacks[i++];

    if (ctx.path !== page.current) {
      ctx.handled = false;
      return;
    }
    if (!fn) return unhandled(ctx);
    fn(ctx, nextEnter);
  }

  if (prev) {
    nextExit();
  } else {
    nextEnter();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {!Context}
 * @api public
 */

page.show = function(path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.<span class="apidocCodeKeywordSpan">dispatch</span>(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
};

/**
 * Goes back in the history
 * Back should always let the current route push state and then go back.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.exit" id="apidoc.element.page.exit">
        function <span class="apidocSignatureSpan">page.</span>exit
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exit = function (path, fn) {
  if (typeof path === 'function') {
    return page.exit('*', path);
  }

  var route = new Route(path);
  for (var i = 1; i &lt; arguments.length; ++i) {
    page.exits.push(route.middleware(arguments[i]));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* docs improved
* tests improved


1.5.0 / 2014-11-29
==================

* added page.<span class="apidocCodeKeywordSpan">exit</span>(path, callback[, callback...])
* added page.redirect(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index" id="apidoc.element.page.index">
        function <span class="apidocSignatureSpan">page.</span>index
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function page(path, fn) {
  // &lt;callback&gt;
  if ('function' === typeof path) {
    return page('*', path);
  }

  // route &lt;path&gt; to &lt;callback ...&gt;
  if ('function' === typeof fn) {
    var route = new Route(/** @type {string} */ (path));
    for (var i = 1; i &lt; arguments.length; ++i) {
      page.callbacks.push(route.middleware(arguments[i]));
    }
    // show &lt;path&gt; with [state]
  } else if ('string' === typeof path) {
    page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
    // start [options]
  } else {
    page.start(path);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.redirect" id="apidoc.element.page.redirect">
        function <span class="apidocSignatureSpan">page.</span>redirect
        <span class="apidocSignatureSpan">(from, to)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">redirect = function (from, to) {
  // Define route from a path to another
  if ('string' === typeof from &amp;&amp; 'string' === typeof to) {
    page(from, function(e) {
      setTimeout(function() {
        page.replace(/** @type {!string} */ (to));
      }, 0);
    });
  }

  // Wait for the push state and replace it with another
  if ('string' === typeof from &amp;&amp; 'undefined' === typeof to) {
    setTimeout(function() {
      page.replace(from);
    }, 0);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* tests improved


1.5.0 / 2014-11-29
==================

* added page.exit(path, callback[, callback...])
* added page.<span class="apidocCodeKeywordSpan">redirect</span>(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================

* fixed: hashbang navigation
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.replace" id="apidoc.element.page.replace">
        function <span class="apidocSignatureSpan">page.</span>replace
        <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replace = function (path, state, init, dispatch) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  ctx.init = init;
  ctx.save(); // save before dispatching, which may redirect
  if (false !== dispatch) page.dispatch(ctx);
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location
.pathname + location.search + location.hash;
  page.<span class="apidocCodeKeywordSpan">replace</span>(url, null, true, dispatch);
};

/**
 * Unbind click and popstate event handlers.
 *
 * @api public
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.sameOrigin" id="apidoc.element.page.sameOrigin">
        function <span class="apidocSignatureSpan">page.</span>sameOrigin
        <span class="apidocSignatureSpan">(href)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sameOrigin(href) {
  var origin = location.protocol + '//' + location.hostname;
  if (location.port) origin += ':' + location.port;
  return (href &amp;&amp; (0 === href.indexOf(origin)));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.show" id="apidoc.element.page.show">
        function <span class="apidocSignatureSpan">page.</span>show
        <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">show = function (path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.dispatch(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
==================

* fix ctrl/cmd/shift clicks

1.3.4 / 2013-02-04
==================

* add tmp .<span class="apidocCodeKeywordSpan">show</span>() dispatch argument
* add keywords to component.json

1.3.3 / 2012-12-14
==================

* remove + support from path regexps
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.start" id="apidoc.element.page.start">
        function <span class="apidocSignatureSpan">page.</span>start
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (options) {
  options = options || {};
  if (running) return;
  running = true;
  if (false === options.dispatch) dispatch = false;
  if (false === options.decodeURLComponents) decodeURLComponents = false;
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location
.search + location.hash;
  page.replace(url, null, true, dispatch);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */

var prevContext;

/**
 * Register `path` with callback `fn()`,
 * or route `path`, or redirection,
 * or `page.<span class="apidocCodeKeywordSpan">start</span>()`.
 *
 *   page(fn);
 *   page('*', fn);
 *   page('/user/:id', load, user);
 *   page('/user/' + user.id, { some: 'thing' });
 *   page('/user/' + user.id);
 *   page('/from', '/to')
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.stop" id="apidoc.element.page.stop">
        function <span class="apidocSignatureSpan">page.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
  if (!running) return;
  page.current = '';
  page.len = 0;
  running = false;
  document.removeEventListener(clickEvent, onclick, false);
  window.removeEventListener('popstate', onpopstate, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (hashbang) {
    current = base + location.hash.replace('#!', '');
  } else {
    current = location.pathname + location.search;
  }

  if (current === ctx.canonicalPath) return;
  page.<span class="apidocCodeKeywordSpan">stop</span>();
  ctx.handled = false;
  location.href = ctx.canonicalPath;
}

/**
 * Register an exit route on `path` with
 * callback `fn()`, which will be called
...</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.Context" id="apidoc.module.page.Context">module page.Context</a></h1>


    <h2>
        <a href="#apidoc.element.page.Context.Context" id="apidoc.element.page.Context.Context">
        function <span class="apidocSignatureSpan">page.</span>Context
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Context(path, state) {
  if ('/' === path[0] &amp;&amp; 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;
  var i = path.indexOf('?');

  this.canonicalPath = path;
  this.path = path.replace(base, '') || '/';
  if (hashbang) this.path = this.path.replace('#!', '') || '/';

  this.title = document.title;
  this.state = state || {};
  this.state.path = path;
  this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';
  this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);
  this.params = {};

  // fragment
  this.hash = '';
  if (!hashbang) {
    if (!~this.path.indexOf('#')) return;
    var parts = this.path.split('#');
    this.path = parts[0];
    this.hash = decodeURLEncodedURIComponent(parts[1]) || '';
    this.querystring = this.querystring.split('#')[0];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.Context.prototype" id="apidoc.module.page.Context.prototype">module page.Context.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.page.Context.prototype.pushState" id="apidoc.element.page.Context.prototype.pushState">
        function <span class="apidocSignatureSpan">page.Context.prototype.</span>pushState
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushState = function () {
  page.len++;
  history.pushState(this.state, this.title, hashbang &amp;&amp; this.path !== '/' ? '#!' + this.path : this.canonicalPath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

page.show = function(path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.dispatch(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.<span class="apidocCodeKeywordSpan">pushState</span>();
  return ctx;
};

/**
 * Goes back in the history
 * Back should always let the current route push state and then go back.
 *
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.Context.prototype.save" id="apidoc.element.page.Context.prototype.save">
        function <span class="apidocSignatureSpan">page.Context.prototype.</span>save
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function () {
  history.replaceState(this.state, this.title, hashbang &amp;&amp; this.path !== '/' ? '#!' + this.path : this.canonicalPath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
1.4.0 / 2014-11-12
==================

* add hashbang support. Closes #112
* add page.redirect() method
* add plugins list to readme
* add Context#handled option
* Fix an issue where redirects in dispatch can be overwritten by ctx.<span class="apidocCodeKeywordSpan">save</span>()
* add support HTML5-History-API polyfill
* make sameOrigin public
* update path-to-regexp
* allow for missing href in anchors.
* update examples
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.Route" id="apidoc.module.page.Route">module page.Route</a></h1>


    <h2>
        <a href="#apidoc.element.page.Route.Route" id="apidoc.element.page.Route.Route">
        function <span class="apidocSignatureSpan">page.</span>Route
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path, options) {
  options = options || {};
  this.path = (path === '*') ? '(.*)' : path;
  this.method = 'GET';
  this.regexp = pathtoRegexp(this.path,
    this.keys = [],
    options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.Route.prototype" id="apidoc.module.page.Route.prototype">module page.Route.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.page.Route.prototype.match" id="apidoc.element.page.Route.prototype.match">
        function <span class="apidocSignatureSpan">page.Route.prototype.</span>match
        <span class="apidocSignatureSpan">(path, params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">match = function (path, params) {
  var keys = this.keys,
    qsIndex = path.indexOf('?'),
    pathname = ~qsIndex ? path.slice(0, qsIndex) : path,
    m = this.regexp.exec(decodeURIComponent(pathname));

  if (!m) return false;

  for (var i = 1, len = m.length; i &lt; len; ++i) {
    var key = keys[i - 1];
    var val = decodeURLEncodedURIComponent(m[i]);
    if (val !== undefined || !(hasOwnProperty.call(params, key.name))) {
      params[key.name] = val;
    }
  }

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {Function}
 * @api public
 */

Route.prototype.middleware = function(fn) {
  var self = this;
  return function(ctx, next) {
    if (self.<span class="apidocCodeKeywordSpan">match</span>(ctx.path, ctx.params)) return fn(ctx, next);
    next();
  };
};

/**
 * Check if this route matches `path`, if so
 * populate `params`.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.Route.prototype.middleware" id="apidoc.element.page.Route.prototype.middleware">
        function <span class="apidocSignatureSpan">page.Route.prototype.</span>middleware
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (fn) {
  var self = this;
  return function(ctx, next) {
    if (self.match(ctx.path, ctx.params)) return fn(ctx, next);
    next();
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return page('*', path);
}

// route &lt;path&gt; to &lt;callback ...&gt;
if ('function' === typeof fn) {
  var route = new Route(/** @type {string} */ (path));
  for (var i = 1; i &lt; arguments.length; ++i) {
    page.callbacks.push(route.<span class="apidocCodeKeywordSpan">middleware</span>(arguments[i]));
  }
  // show &lt;path&gt; with [state]
} else if ('string' === typeof path) {
  page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
  // start [options]
} else {
  page.start(path);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.index" id="apidoc.module.page.index">module page.index</a></h1>


    <h2>
        <a href="#apidoc.element.page.index.index" id="apidoc.element.page.index.index">
        function <span class="apidocSignatureSpan">page.</span>index
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function page(path, fn) {
  // &lt;callback&gt;
  if ('function' === typeof path) {
    return page('*', path);
  }

  // route &lt;path&gt; to &lt;callback ...&gt;
  if ('function' === typeof fn) {
    var route = new Route(/** @type {string} */ (path));
    for (var i = 1; i &lt; arguments.length; ++i) {
      page.callbacks.push(route.middleware(arguments[i]));
    }
    // show &lt;path&gt; with [state]
  } else if ('string' === typeof path) {
    page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
    // start [options]
  } else {
    page.start(path);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.Context" id="apidoc.element.page.index.Context">
        function <span class="apidocSignatureSpan">page.index.</span>Context
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Context(path, state) {
  if ('/' === path[0] &amp;&amp; 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;
  var i = path.indexOf('?');

  this.canonicalPath = path;
  this.path = path.replace(base, '') || '/';
  if (hashbang) this.path = this.path.replace('#!', '') || '/';

  this.title = document.title;
  this.state = state || {};
  this.state.path = path;
  this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';
  this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);
  this.params = {};

  // fragment
  this.hash = '';
  if (!hashbang) {
    if (!~this.path.indexOf('#')) return;
    var parts = this.path.split('#');
    this.path = parts[0];
    this.hash = decodeURLEncodedURIComponent(parts[1]) || '';
    this.querystring = this.querystring.split('#')[0];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.Route" id="apidoc.element.page.index.Route">
        function <span class="apidocSignatureSpan">page.index.</span>Route
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path, options) {
  options = options || {};
  this.path = (path === '*') ? '(.*)' : path;
  this.method = 'GET';
  this.regexp = pathtoRegexp(this.path,
    this.keys = [],
    options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.back" id="apidoc.element.page.index.back">
        function <span class="apidocSignatureSpan">page.index.</span>back
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">back = function (path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.back();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
      page.show(base, state);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

page.back = function(path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.<span class="apidocCodeKeywordSpan">back</span>();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.base" id="apidoc.element.page.index.base">
        function <span class="apidocSignatureSpan">page.index.</span>base
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base = function (path) {
  if (0 === arguments.length) return base;
  base = path;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * Fixed `location.origin` usage [fisch42]
  * Fixed `pushState()` when unhandled

1.1.0 / 2012-06-06
==================

  * Added `+` support to pathtoRegexp()
  * Added `page.<span class="apidocCodeKeywordSpan">base</span>(path)` support
  * Added dispatch option to `page()`. Closes #10
  * Added `Context#originalPath`
  * Fixed unhandled links when .base is present. Closes #11
  * Fixed: `Context#path` to "/"

0.0.2 / 2012-06-05
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.dispatch" id="apidoc.element.page.index.dispatch">
        function <span class="apidocSignatureSpan">page.index.</span>dispatch
        <span class="apidocSignatureSpan">(ctx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (ctx) {
  var prev = prevContext,
    i = 0,
    j = 0;

  prevContext = ctx;

  function nextExit() {
    var fn = page.exits[j++];
    if (!fn) return nextEnter();
    fn(prev, nextExit);
  }

  function nextEnter() {
    var fn = page.callbacks[i++];

    if (ctx.path !== page.current) {
      ctx.handled = false;
      return;
    }
    if (!fn) return unhandled(ctx);
    fn(ctx, nextEnter);
  }

  if (prev) {
    nextExit();
  } else {
    nextEnter();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {!Context}
 * @api public
 */

page.show = function(path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.<span class="apidocCodeKeywordSpan">dispatch</span>(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
};

/**
 * Goes back in the history
 * Back should always let the current route push state and then go back.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.exit" id="apidoc.element.page.index.exit">
        function <span class="apidocSignatureSpan">page.index.</span>exit
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exit = function (path, fn) {
  if (typeof path === 'function') {
    return page.exit('*', path);
  }

  var route = new Route(path);
  for (var i = 1; i &lt; arguments.length; ++i) {
    page.exits.push(route.middleware(arguments[i]));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* docs improved
* tests improved


1.5.0 / 2014-11-29
==================

* added page.<span class="apidocCodeKeywordSpan">exit</span>(path, callback[, callback...])
* added page.redirect(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.redirect" id="apidoc.element.page.index.redirect">
        function <span class="apidocSignatureSpan">page.index.</span>redirect
        <span class="apidocSignatureSpan">(from, to)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">redirect = function (from, to) {
  // Define route from a path to another
  if ('string' === typeof from &amp;&amp; 'string' === typeof to) {
    page(from, function(e) {
      setTimeout(function() {
        page.replace(/** @type {!string} */ (to));
      }, 0);
    });
  }

  // Wait for the push state and replace it with another
  if ('string' === typeof from &amp;&amp; 'undefined' === typeof to) {
    setTimeout(function() {
      page.replace(from);
    }, 0);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* tests improved


1.5.0 / 2014-11-29
==================

* added page.exit(path, callback[, callback...])
* added page.<span class="apidocCodeKeywordSpan">redirect</span>(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================

* fixed: hashbang navigation
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.replace" id="apidoc.element.page.index.replace">
        function <span class="apidocSignatureSpan">page.index.</span>replace
        <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replace = function (path, state, init, dispatch) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  ctx.init = init;
  ctx.save(); // save before dispatching, which may redirect
  if (false !== dispatch) page.dispatch(ctx);
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location
.pathname + location.search + location.hash;
  page.<span class="apidocCodeKeywordSpan">replace</span>(url, null, true, dispatch);
};

/**
 * Unbind click and popstate event handlers.
 *
 * @api public
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.sameOrigin" id="apidoc.element.page.index.sameOrigin">
        function <span class="apidocSignatureSpan">page.index.</span>sameOrigin
        <span class="apidocSignatureSpan">(href)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sameOrigin(href) {
  var origin = location.protocol + '//' + location.hostname;
  if (location.port) origin += ':' + location.port;
  return (href &amp;&amp; (0 === href.indexOf(origin)));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.show" id="apidoc.element.page.index.show">
        function <span class="apidocSignatureSpan">page.index.</span>show
        <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">show = function (path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.dispatch(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
==================

* fix ctrl/cmd/shift clicks

1.3.4 / 2013-02-04
==================

* add tmp .<span class="apidocCodeKeywordSpan">show</span>() dispatch argument
* add keywords to component.json

1.3.3 / 2012-12-14
==================

* remove + support from path regexps
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.start" id="apidoc.element.page.index.start">
        function <span class="apidocSignatureSpan">page.index.</span>start
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (options) {
  options = options || {};
  if (running) return;
  running = true;
  if (false === options.dispatch) dispatch = false;
  if (false === options.decodeURLComponents) decodeURLComponents = false;
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location
.search + location.hash;
  page.replace(url, null, true, dispatch);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */

var prevContext;

/**
 * Register `path` with callback `fn()`,
 * or route `path`, or redirection,
 * or `page.<span class="apidocCodeKeywordSpan">start</span>()`.
 *
 *   page(fn);
 *   page('*', fn);
 *   page('/user/:id', load, user);
 *   page('/user/' + user.id, { some: 'thing' });
 *   page('/user/' + user.id);
 *   page('/from', '/to')
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.index.stop" id="apidoc.element.page.index.stop">
        function <span class="apidocSignatureSpan">page.index.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
  if (!running) return;
  page.current = '';
  page.len = 0;
  running = false;
  document.removeEventListener(clickEvent, onclick, false);
  window.removeEventListener('popstate', onpopstate, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (hashbang) {
    current = base + location.hash.replace('#!', '');
  } else {
    current = location.pathname + location.search;
  }

  if (current === ctx.canonicalPath) return;
  page.<span class="apidocCodeKeywordSpan">stop</span>();
  ctx.handled = false;
  location.href = ctx.canonicalPath;
}

/**
 * Register an exit route on `path` with
 * callback `fn()`, which will be called
...</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.page.page" id="apidoc.module.page.page">module page.page</a></h1>


    <h2>
        <a href="#apidoc.element.page.page.page" id="apidoc.element.page.page.page">
        function <span class="apidocSignatureSpan">page.</span>page
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function page(path, fn) {
  // &lt;callback&gt;
  if ('function' === typeof path) {
    return page('*', path);
  }

  // route &lt;path&gt; to &lt;callback ...&gt;
  if ('function' === typeof fn) {
    var route = new Route(/** @type {string} */ (path));
    for (var i = 1; i &lt; arguments.length; ++i) {
      page.callbacks.push(route.middleware(arguments[i]));
    }
    // show &lt;path&gt; with [state]
  } else if ('string' === typeof path) {
    page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
    // start [options]
  } else {
    page.start(path);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.Context" id="apidoc.element.page.page.Context">
        function <span class="apidocSignatureSpan">page.page.</span>Context
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Context(path, state) {
  if ('/' === path[0] &amp;&amp; 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;
  var i = path.indexOf('?');

  this.canonicalPath = path;
  this.path = path.replace(base, '') || '/';
  if (hashbang) this.path = this.path.replace('#!', '') || '/';

  this.title = document.title;
  this.state = state || {};
  this.state.path = path;
  this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';
  this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);
  this.params = {};

  // fragment
  this.hash = '';
  if (!hashbang) {
    if (!~this.path.indexOf('#')) return;
    var parts = this.path.split('#');
    this.path = parts[0];
    this.hash = decodeURLEncodedURIComponent(parts[1]) || '';
    this.querystring = this.querystring.split('#')[0];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.Route" id="apidoc.element.page.page.Route">
        function <span class="apidocSignatureSpan">page.page.</span>Route
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path, options) {
  options = options || {};
  this.path = (path === '*') ? '(.*)' : path;
  this.method = 'GET';
  this.regexp = pathtoRegexp(this.path,
    this.keys = [],
    options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.back" id="apidoc.element.page.page.back">
        function <span class="apidocSignatureSpan">page.page.</span>back
        <span class="apidocSignatureSpan">(path, state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">back = function (path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.back();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
      page.show(base, state);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

page.back = function(path, state) {
  if (page.len &gt; 0) {
    // this may need more testing to see if all browsers
    // wait for the next tick to go back in history
    history.<span class="apidocCodeKeywordSpan">back</span>();
    page.len--;
  } else if (path) {
    setTimeout(function() {
      page.show(path, state);
    });
  }else{
    setTimeout(function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.base" id="apidoc.element.page.page.base">
        function <span class="apidocSignatureSpan">page.page.</span>base
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base = function (path) {
  if (0 === arguments.length) return base;
  base = path;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * Fixed `location.origin` usage [fisch42]
  * Fixed `pushState()` when unhandled

1.1.0 / 2012-06-06
==================

  * Added `+` support to pathtoRegexp()
  * Added `page.<span class="apidocCodeKeywordSpan">base</span>(path)` support
  * Added dispatch option to `page()`. Closes #10
  * Added `Context#originalPath`
  * Fixed unhandled links when .base is present. Closes #11
  * Fixed: `Context#path` to "/"

0.0.2 / 2012-06-05
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.dispatch" id="apidoc.element.page.page.dispatch">
        function <span class="apidocSignatureSpan">page.page.</span>dispatch
        <span class="apidocSignatureSpan">(ctx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (ctx) {
  var prev = prevContext,
    i = 0,
    j = 0;

  prevContext = ctx;

  function nextExit() {
    var fn = page.exits[j++];
    if (!fn) return nextEnter();
    fn(prev, nextExit);
  }

  function nextEnter() {
    var fn = page.callbacks[i++];

    if (ctx.path !== page.current) {
      ctx.handled = false;
      return;
    }
    if (!fn) return unhandled(ctx);
    fn(ctx, nextEnter);
  }

  if (prev) {
    nextExit();
  } else {
    nextEnter();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {!Context}
 * @api public
 */

page.show = function(path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.<span class="apidocCodeKeywordSpan">dispatch</span>(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
};

/**
 * Goes back in the history
 * Back should always let the current route push state and then go back.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.exit" id="apidoc.element.page.page.exit">
        function <span class="apidocSignatureSpan">page.page.</span>exit
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exit = function (path, fn) {
  if (typeof path === 'function') {
    return page.exit('*', path);
  }

  var route = new Route(path);
  for (var i = 1; i &lt; arguments.length; ++i) {
    page.exits.push(route.middleware(arguments[i]));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* docs improved
* tests improved


1.5.0 / 2014-11-29
==================

* added page.<span class="apidocCodeKeywordSpan">exit</span>(path, callback[, callback...])
* added page.redirect(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.redirect" id="apidoc.element.page.page.redirect">
        function <span class="apidocSignatureSpan">page.page.</span>redirect
        <span class="apidocSignatureSpan">(from, to)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">redirect = function (from, to) {
  // Define route from a path to another
  if ('string' === typeof from &amp;&amp; 'string' === typeof to) {
    page(from, function(e) {
      setTimeout(function() {
        page.replace(/** @type {!string} */ (to));
      }, 0);
    });
  }

  // Wait for the push state and replace it with another
  if ('string' === typeof from &amp;&amp; 'undefined' === typeof to) {
    setTimeout(function() {
      page.replace(from);
    }, 0);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* tests improved


1.5.0 / 2014-11-29
==================

* added page.exit(path, callback[, callback...])
* added page.<span class="apidocCodeKeywordSpan">redirect</span>(url)
* fix: ignore links with `download` attribute
* fix: remove URL encoding before parsing paths

1.4.1 / 2014-11-14
==================

* fixed: hashbang navigation
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.replace" id="apidoc.element.page.page.replace">
        function <span class="apidocSignatureSpan">page.page.</span>replace
        <span class="apidocSignatureSpan">(path, state, init, dispatch)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replace = function (path, state, init, dispatch) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  ctx.init = init;
  ctx.save(); // save before dispatching, which may redirect
  if (false !== dispatch) page.dispatch(ctx);
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location
.pathname + location.search + location.hash;
  page.<span class="apidocCodeKeywordSpan">replace</span>(url, null, true, dispatch);
};

/**
 * Unbind click and popstate event handlers.
 *
 * @api public
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.sameOrigin" id="apidoc.element.page.page.sameOrigin">
        function <span class="apidocSignatureSpan">page.page.</span>sameOrigin
        <span class="apidocSignatureSpan">(href)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sameOrigin(href) {
  var origin = location.protocol + '//' + location.hostname;
  if (location.port) origin += ':' + location.port;
  return (href &amp;&amp; (0 === href.indexOf(origin)));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.show" id="apidoc.element.page.page.show">
        function <span class="apidocSignatureSpan">page.page.</span>show
        <span class="apidocSignatureSpan">(path, state, dispatch, push)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">show = function (path, state, dispatch, push) {
  var ctx = new Context(path, state);
  page.current = ctx.path;
  if (false !== dispatch) page.dispatch(ctx);
  if (false !== ctx.handled &amp;&amp; false !== push) ctx.pushState();
  return ctx;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
==================

* fix ctrl/cmd/shift clicks

1.3.4 / 2013-02-04
==================

* add tmp .<span class="apidocCodeKeywordSpan">show</span>() dispatch argument
* add keywords to component.json

1.3.3 / 2012-12-14
==================

* remove + support from path regexps
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.start" id="apidoc.element.page.page.start">
        function <span class="apidocSignatureSpan">page.page.</span>start
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (options) {
  options = options || {};
  if (running) return;
  running = true;
  if (false === options.dispatch) dispatch = false;
  if (false === options.decodeURLComponents) decodeURLComponents = false;
  if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
  if (false !== options.click) {
    document.addEventListener(clickEvent, onclick, false);
  }
  if (true === options.hashbang) hashbang = true;
  if (!dispatch) return;
  var url = (hashbang &amp;&amp; ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location
.search + location.hash;
  page.replace(url, null, true, dispatch);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */

var prevContext;

/**
 * Register `path` with callback `fn()`,
 * or route `path`, or redirection,
 * or `page.<span class="apidocCodeKeywordSpan">start</span>()`.
 *
 *   page(fn);
 *   page('*', fn);
 *   page('/user/:id', load, user);
 *   page('/user/' + user.id, { some: 'thing' });
 *   page('/user/' + user.id);
 *   page('/from', '/to')
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.page.page.stop" id="apidoc.element.page.page.stop">
        function <span class="apidocSignatureSpan">page.page.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
  if (!running) return;
  page.current = '';
  page.len = 0;
  running = false;
  document.removeEventListener(clickEvent, onclick, false);
  window.removeEventListener('popstate', onpopstate, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (hashbang) {
    current = base + location.hash.replace('#!', '');
  } else {
    current = location.pathname + location.search;
  }

  if (current === ctx.canonicalPath) return;
  page.<span class="apidocCodeKeywordSpan">stop</span>();
  ctx.handled = false;
  location.href = ctx.canonicalPath;
}

/**
 * Register an exit route on `path` with
 * callback `fn()`, which will be called
...</pre></li>
    </ul>










</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>